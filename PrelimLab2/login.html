<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Attendance Tracker</title>
<style>
body {
    font-family: "Segoe UI", sans-serif;
    background: #f5f1ec;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    height: 100vh;
    padding-top: 30px;
}
.box {
    background: white;
    padding: 30px;
    width: 420px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
h2 { text-align: center; }
input { width: 100%; padding: 10px; margin-top: 10px; font-size: 16px; }
button { width: 100%; margin-top: 15px; padding: 10px; font-size: 16px; background: #3c7ec5; color: white; border: none; cursor: pointer; }
button:hover { opacity: 0.9; }
#userInfo { margin-top: 10px; font-weight: bold; text-align: center; }
#recordsTable {
    border-collapse: collapse;
    width: 100%;
    margin-top: 20px;
    display: none;
}
#recordsTable th, #recordsTable td { border: 1px solid #ddd; padding: 8px; font-size: 14px; }
#recordsTable th { background-color: #ffb74d; color: white; text-align: left; }
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.4);
    justify-content: center;
    align-items: center;
}
.modal-content {
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    min-width: 250px;
    text-align: center;
}
.modal-content.success { border: 3px solid green; }
.modal-content.error { border: 3px solid red; }
.modal button { width: auto; margin-top: 15px; }
</style>
</head>
<body>

<div class="box">
    <h2>Attendance Tracker</h2>
    <input type="text" id="username" placeholder="Username (e.g. name@uphmo)">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login & Submit Attendance</button>
    <button onclick="toggleRecords()">View Records</button>
    <p id="userInfo"></p>

    <table id="recordsTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Course</th>
                <th>Time In</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<!-- Modal Notification -->
<div id="modal" class="modal">
    <div class="modal-content" id="modalContent">
        <p id="modalMessage"></p>
        <button onclick="closeModal()">OK</button>
    </div>
</div>

<!-- ERROR SOUND -->
<audio id="beep" src="C:\Users\zeus\Documents\2nSEMprog\AttendanceTracker\prog2\chime.mp3"></audio>

<script>
/* ===== USERS DATABASE ===== */
let usersDB = {
    "justin@uphmo": {password: "1234", realName: "Justin Laxa", course: "BSCS - Data Science"},
    "cyrus@uphmo": {password: "abcd", realName: "Cyrus Magbanua", course: "BSIT - Game Development"},
    "price@uphmo": {password: "5678", realName: "Priceah Guzman", course: "BSIT - Game Development"},
    "bill@uphmo": {password: "efgh", realName: "Bill Griar", course: "BSCS - Data Science"},
    "migs@uphmo": {password: "91011", realName: "Migs Urbino", course: "BSCS - Data Science"},
    "charles@rtu": {password: "ijkl", realName: "Charles Monter", course: "BSEE - Electrical Engineering"},
    "mario@umak": {password: "mariojudah", realName: "Mario Torio", course: "BSSM - Sports Management"},
    "anth@rtu": {password: "nonchalant", realName: "Anthony Corocoto", course: "BSCE - Civil Engineering"},
    "lijah@dlsu": {password: "hypebeast", realName: "Elijah Linsoco", course: "BSP - Psychology"}
};

let attendanceRecords = [];

/* ===== MODAL FUNCTIONS ===== */
function showModal(message, type="success"){
    const modal = document.getElementById("modal");
    const modalContent = document.getElementById("modalContent");
    const modalMessage = document.getElementById("modalMessage");
    modalMessage.innerText = message;
    modalContent.className = `modal-content ${type}`;
    modal.style.display = "flex";
}
function closeModal(){ document.getElementById("modal").style.display = "none"; }

/* ===== LOGIN & SUBMIT ATTENDANCE ===== */
function login() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();

    if(usersDB[username] && usersDB[username].password === password){
        if(attendanceRecords.some(r => r.username === username)){
            showModal("This user has already submitted attendance!", "error");
            return;
        }
        const user = usersDB[username];
        const now = new Date();
        const timeIn = now.getFullYear()+"-"+String(now.getMonth()+1).padStart(2,"0")+"-"+String(now.getDate()).padStart(2,"0")+
                       " "+String(now.getHours()).padStart(2,"0")+":"+String(now.getMinutes()).padStart(2,"0")+":"+String(now.getSeconds()).padStart(2,"0");
        attendanceRecords.push({username, realName: user.realName, course: user.course, timeIn});
        document.getElementById("userInfo").innerText = `Name: ${user.realName} | Course: ${user.course} | Time: ${timeIn}`;
        showModal("Login and attendance submitted successfully!", "success");
        document.getElementById("username").value = "";
        document.getElementById("password").value = "";
        // auto-collapse table if open
        document.getElementById("recordsTable").style.display = "none";
    } else {
        const beep = document.getElementById("beep");
        beep.currentTime = 0;
        beep.play();
        showModal("Invalid username or password!", "error");
    }
}

/* ===== COLLAPSIBLE VIEW RECORDS ===== */
function toggleRecords() {
    const table = document.getElementById("recordsTable");
    if (table.style.display === "none" || table.style.display === "") {
        // Fill table
        const tbody = table.querySelector("tbody");
        tbody.innerHTML = "";
        attendanceRecords.forEach(r=>{
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${r.realName}</td><td>${r.course}</td><td>${r.timeIn}</td>`;
            tbody.appendChild(tr);
        });
        table.style.display = "table";
    } else {
        table.style.display = "none";
    }
}

/* ===== ENTER KEY BEHAVIORS ===== */
document.getElementById("username").addEventListener("keydown", e => {
    if(e.key === "Enter") document.getElementById("password").focus();
});
document.getElementById("password").addEventListener("keydown", e => {
    if(e.key === "Enter") login();
});
</script>
</body>
</html>
